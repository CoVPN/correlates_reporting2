# primary_assays: optional. 
#       If not defined, multitesting adjustment is over all assays. If defined, multitesting adjustment is only over this subset. If this set is empty, then no multitesting adjustment is done

# multivariate_assays and additional_models are nAb.st2.sen optional. 
#       The difference between the two is that in multivariate_assays for each formula, nAb.st2.sen models are fit, once scaled and once non-scaled 
#           and that in multivariate_assays, a generalized wald test p value is computed over all markers
#       another difference is that covariates is automatically adjusted in multivariate but not in additional

# interaction: optional. 
#       For each interaction model, a regression coefficient table and two marginalized risk curves plots with bootstrap are made, one with marker a on the x axis and evaluated at three levels of marker b,
#           and the other with marker b on the x axis and evaluated at three levels of marker a
#       The three levels of markers are 15, 50, 85 percentiles by default, but can be changed via special handling code in the R scripts

# Notes: use inherits to overwrite an attribute



###################################################################################################
# trials

default: &default
  is_ows_trial: no
  sampling_scheme: none
  use_ensemble_sl: no
  
  threshold_grid_size: 30
  threshold_monotone_only: no
  threshold_fast: no
  threshold_superfast: yes


####################################################################
# OWS trials

ows_trial: &ows_trial
  forestplot_script: cor_coxph_forestplots_ows.R
  is_ows_trial: yes
  sampling_scheme: case_cohort
  Bserostatus: 0 # use inherits to overwrite

moderna_trial: &moderna_trial
  <<: *ows_trial
  llox_label: LOD
  two_marker_timepoints: yes
  timepoints: [29, 57]
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid80, liveneutmn50]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 80% Titer, Live Virus Micro Neut 50% Titer]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID80 (IU80/ml), Live Virus-MN50 (IU50/ml)]
  times: [B, Day29, Day57, Delta29overB, Delta57overB, Delta57over29]
  time_labels: [Day 1, Day 29, Day 57, D29 fold-rise over D1, D57 fold-rise over D1, D57 fold-rise over D29]
  study_name_code: COVE
  covariates: ~.+ MinorityInd + HighRiskInd + risk_score
  covariates_norisksco: ~.+ MinorityInd + HighRiskInd + Age
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no

moderna_real: &moderna_real
  <<: *moderna_trial
  #data_cleaned: /trials/covpn/p3001/analysis/correlates/Part_A_Blinded_Phase_Data/adata/P3001ModernaCOVEimmunemarkerdata_correlates_processed_v1.1_lvmn_added_Jan14_2022.csv # for the lvmn manuscript
  data_cleaned: /trials/covpn/p3001/analysis/correlates/Part_A_Blinded_Phase_Data/adata/moderna_real_data_processed_20230919.csv
  study_name: COVE
  multivariate_assays: [
    bindRBD + pseudoneutid50 + liveneutmn50, 
    pseudoneutid50 + liveneutmn50
  ]
  num_boot_replicates: 1000
  num_perm_replicates: 10000

moderna_mock: &moderna_mock
  <<: *moderna_trial
  data_cleaned: NA
  study_name: MockCOVE
  num_boot_replicates: 10
  num_perm_replicates: 10
  

moderna_boost: &moderna_boost
  study_name: COVEBoost
  txt.endpoint: COVID
  timepoints: [29]
  times: [BD1, BD29, DeltaBD29overBD1]
  time_labels: [BD1, BD29, BD29/BD1]
  data_cleaned: /trials/covpn/p3001/analysis/correlates/Part_C_Unblinded_Phase_Data/adata/moderna_boost_data_processed_20230819.csv
  assay_metadata: assay_metadata/moderna_boost_assay_metadata.csv
  sampling_scheme: case_control
  covariates: ~. + MinorityInd + HighRiskInd + risk_score
  multivariate_assays: [
    BD1bindSpike_BA.1,
    BD29bindSpike_BA.1,
    BD1bindSpike_BA.1 + BD29bindSpike_BA.1,
    BD1bindSpike_BA.1 * BD29bindSpike_BA.1,
    
    BD1bindSpike + BD29bindSpike,
    BD1pseudoneutid50_BA.1 + BD29pseudoneutid50_BA.1, 
    BD1pseudoneutid50 + BD29pseudoneutid50,

    BD29pseudoneutid50_BA.1 + BD29pseudoneutid50, 
    BD29bindSpike_BA.1 + BD29bindSpike, 
    BD29pseudoneutid50_BA.1 + BD29bindSpike_BA.1, 
    BD29pseudoneutid50 + BD29bindSpike, 
    
    DeltaBD29overBD1pseudoneutid50_BA.1 + DeltaBD29overBD1pseudoneutid50, 
    DeltaBD29overBD1bindSpike_BA.1 + DeltaBD29overBD1bindSpike, 
    DeltaBD29overBD1pseudoneutid50_BA.1 + DeltaBD29overBD1bindSpike_BA.1, 
    DeltaBD29overBD1pseudoneutid50 + DeltaBD29overBD1bindSpike
  ]
  interaction: [
    BD1bindSpike_BA.1 * BD29bindSpike_BA.1,
    BD1bindSpike_BA.1 * DeltaBD29overBD1bindSpike_BA.1,
    BD1pseudoneutid50_BA.1 * BD29pseudoneutid50_BA.1, 
    BD1pseudoneutid50_BA.1 * DeltaBD29overBD1pseudoneutid50_BA.1
  ]
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  ph1: [ph1.BD29]
  endpoints: [EventIndOmicron]
  peak_visit: BD29
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post BD29 visit; no. cases = number of this cohort with an observed COVID endpoint. 

  
  

janssen_trial: &janssen_trial
  <<: *ows_trial
  two_marker_timepoints: no
  timepoints: [29]
  times: [B, Day29, Delta29overB]
  time_labels: [Day 1, Day 29, D29 fold-rise over D1]
  study_name_code: ENSEMBLE
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: yes # used to drive some plotting configurations


janssen_trial_partA: &janssen_trial_partA # binding Ab and ID50 and ADCP
  <<: *janssen_trial
  primary_assays: [bindSpike, bindRBD, pseudoneutid50, ADCP]
  study_name: ENSEMBLE
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  multivariate_assays: [
            bindSpike+bindRBD+pseudoneutid50+ADCP
  ]

janssen_pooled_partA: &janssen_pooled_partA
  <<: *janssen_trial_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_pooled_partA_data_processed_with_riskscore_20240226.csv
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid50uncensored, ADCP]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 50% Titer 2, Phagocytic Score]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID50 (IU50/ml) 2, Phagocytic Score]
  llox_label: [POS, POS, LLOQ, LLOQ, LOD] 
  covariates: ~.+ risk_score + as.factor(Region)
  additional_models: [
    risk_score + as.factor(Region) + DaytpeakbindSpike + Daytpeakpseudoneutid50,
    risk_score + as.factor(Region) + Daytpeakpseudoneutid50 + DaytpeakADCP
  ]

janssen_pooled_partAsenior: &janssen_pooled_partAsenior
  inherits: janssen_pooled_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_pooled_partAsenior_data_processed_with_riskscore.csv

janssen_pooled_partAnonsenior: &janssen_pooled_partAnonsenior
  inherits: janssen_pooled_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_pooled_partAnonsenior_data_processed_with_riskscore.csv

janssen_na_partA: &janssen_na_partA
  <<: *janssen_trial_partA
  assays: [bindSpike, bindRBD, pseudoneutid50, ADCP]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, Phagocytic Score]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Phagocytic Score]
  llox_label: [LOD, LOD, LLOQ, LLOQ]
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_na_partA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  additional_models: [
    risk_score + DaytpeakbindSpike + Daytpeakpseudoneutid50,
    risk_score + Daytpeakpseudoneutid50 + DaytpeakADCP
  ]

janssen_na_partAsenior: &janssen_na_partAsenior
  inherits: janssen_na_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_na_partAsenior_data_processed_with_riskscore.csv

janssen_na_partAnonsenior: &janssen_na_partAnonsenior
  inherits: janssen_na_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_na_partAnonsenior_data_processed_with_riskscore.csv

janssen_la_partA: &janssen_la_partA
  <<: *janssen_trial_partA
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid50la, ADCP]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 50% Titer (LA), Phagocytic Score]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID50 LA (IU50/ml), Phagocytic Score]
  llox_label: [LOD, LOD, LLOQ, LLOQ, LLOQ]
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_la_partA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  additional_models: [
    risk_score + DaytpeakbindSpike + Daytpeakpseudoneutid50,
    risk_score + Daytpeakpseudoneutid50 + DaytpeakADCP
  ]
  variants: [Ancestral.Lineage,Zeta,Mu,Gamma,Lambda]

janssen_la_partAsenior: &janssen_la_partAsenior
  inherits: janssen_la_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_la_partAsenior_data_processed_with_riskscore.csv

janssen_la_partAnonsenior: &janssen_la_partAnonsenior
  inherits: janssen_la_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_la_partAnonsenior_data_processed_with_riskscore.csv

janssen_sa_partA: &janssen_sa_partA
  <<: *janssen_trial_partA
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid50sa, ADCP]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 50% Titer (SA), Phagocytic Score]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID50 (SA) (IU50/ml), Phagocytic Score]
  llox_label: [LOD, LOD, LLOQ, LLOQ, LLOQ]
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_sa_partA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  additional_models: [
    risk_score + DaytpeakbindSpike + Daytpeakpseudoneutid50,
    risk_score + Daytpeakpseudoneutid50 + DaytpeakADCP
  ]

janssen_sa_partAsenior: &janssen_sa_partAsenior
  inherits: janssen_sa_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_sa_partAsenior_data_processed_with_riskscore.csv

janssen_sa_partAnonsenior: &janssen_sa_partAnonsenior
  inherits: janssen_sa_partA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_sa_partAnonsenior_data_processed_with_riskscore.csv



janssen_partA_VL: &janssen_partA_VL 
  <<: *janssen_trial
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_partA_VL_data_processed_20240226.csv
  assay_metadata: assay_metadata/janssen_partA_VL_assay_metadata.csv
  covariates: ~.+ risk_score
  study_name: ENSEMBLE
  num_boot_replicates: 1000
  num_perm_replicates: 10




janssen_trial_EUA: &janssen_trial_EUA # binding Ab and ID50
  <<: *janssen_trial
  primary_assays: [bindSpike, bindRBD, pseudoneutid50]
  study_name: ENSEMBLE
  num_boot_replicates: 1000
  num_perm_replicates: 10000

janssen_pooled_EUA:
  <<: *janssen_trial_EUA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_pooled_EUA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score + as.factor(Region)
  covariates_norisksco: ~.+ Age        + as.factor(Region)
  assays: [bindSpike, bindRBD, pseudoneutid50]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml)]
  llox_label: [LOD, LOD, LLOQ]
  additional_models: [
    as.factor(Region) + MinorityInd + Sex + Senior + HighRiskInd + DaytpeakbindSpike,
    as.factor(Region) + MinorityInd + Sex + Senior + HighRiskInd + DaytpeakbindRBD,
    as.factor(Region) + MinorityInd + Sex + Senior + HighRiskInd + Daytpeakpseudoneutid50
  ]

janssen_na_EUA:
  <<: *janssen_trial_EUA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_na_EUA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age
  assays: [bindSpike, bindRBD, pseudoneutid50]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml)]
  llox_label: [LOD, LOD, LLOQ]

janssen_la_EUA:
  <<: *janssen_trial_EUA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_la_EUA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid50la]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 50% Titer (LA)]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID50 (LA) (IU50/ml)]
  llox_label: [LOD, LOD, LLOQ, LLOQ]

janssen_sa_EUA:
  <<: *janssen_trial_EUA
  data_cleaned: /trials/covpn/p3003/analysis/correlates/Part_A_Blinded_Phase_Data/adata/janssen_sa_EUA_data_processed_with_riskscore.csv
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age
  assays: [bindSpike, bindRBD, pseudoneutid50, pseudoneutid50sa]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer, PsV Neutralization 50% Titer (SA)]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml), Pseudovirus-nAb ID50 (SA) (IU50/ml)]
  llox_label: [LOD, LOD, LLOQ, LLOQ]



janssen_trial_mock: &janssen_trial_mock
  <<: *janssen_trial
  data_cleaned: NA
  assays: [bindSpike, bindRBD]
  llox_label: LOD 
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml)]
  study_name: MockENSEMBLE
  num_boot_replicates: 10
  num_perm_replicates: 10

janssen_pooled_mock:
  <<: *janssen_trial_mock
  covariates: ~.+ risk_score + as.factor(Region)
  covariates_norisksco: ~.+ Age        + as.factor(Region)

janssen_na_mock:
  <<: *janssen_trial_mock
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age

janssen_la_mock:
  <<: *janssen_trial_mock
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age

janssen_sa_mock:
  <<: *janssen_trial_mock
  covariates: ~.+ risk_score
  covariates_norisksco: ~.+ Age

# not extending ows trial b/c don't want Bserostatus defined, which affects subset in _common.R
vat08_combined: &vat08_combined
  data_cleaned: /trials/covpn/p3005/analysis/correlates/Part_A_Blinded_Phase_Data/adata/vat08_combined_data_processed_20240501.csv
  sampling_scheme: case_cohort
  two_marker_timepoints: yes
  timepoints: [22, 43]
  times: [B, Day22, Day43, Delta22overB, Delta43overB, Delta43over22]
  time_labels: [Day 1, Day 22, Day 43, D22 fold-rise over D1, D43 fold-rise over D1, D43 fold-rise over D22]
  study_name: VAT08
  assay_metadata: assay_metadata/vat08_combined_assay_metadata.csv
  covariates: ~.+ FOI + risk_score + Sex + strata(Country)
  low_efficacy: no
  num_boot_replicates: 10
  num_perm_replicates: 10


covail: &covail
  data_cleaned: /trials/covpn/COVAILcorrelates/analysis/correlates/adata/covail_data_processed_20240313.csv
  sampling_scheme: cohort
  two_marker_timepoints: no
  timepoints: [15,29,85,91,147,181]
  times: [B, Day15, Delta15overB, Day29, Delta29overB]
  time_labels: [Day 1, Day 15, D15 fold-rise over D1, Day 29, D29 fold-rise over D1]
  study_name: COVAIL
  assay_metadata: assay_metadata/covail_assay_metadata.csv
  covariates: ~.+ FOIstandardized + standardized_risk_score + naive
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10
  primary_assays: []

# a copy of covail, used to drive Makefile
covail_sanofi: &covail_sanofi
  inherits: covail


prevent19: &prevent19
  <<: *ows_trial
  two_marker_timepoints: no
  timepoints: [35]
  times: [B, Day35, Delta35overB]
  time_labels: [Day 1, Day 35, D35 fold-rise over D1]
  data_cleaned: /trials/covpn/p3004/analysis/correlates/Part_A_Blinded_Phase_Data/adata/prevent19_data_processed_20240325.csv
  assays: [bindSpike, bindRBD, pseudoneutid50]
  llox_label: [LLOQ, LLOQ, LOD]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to RBD, PsV Neutralization 50% Titer]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti RBD IgG (BAU/ml), Pseudovirus-nAb ID50 (IU50/ml)]
  study_name: PREVENT19
  covariates: ~.+ risk_score
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000 
  

  
# share a data file with prevent19, but focus on two NVX assays
prevent19nvx: &prevent19nvx
  inherits: ows_trial
  sampling_scheme: case_control
  two_marker_timepoints: no
  timepoints: [35]
  times: [B, Day35, Delta35overB]
  time_labels: [Day 1, Day 35, D35 fold-rise over D1]
  data_cleaned: /trials/covpn/p3004/analysis/correlates/Part_A_Blinded_Phase_Data/adata/prevent19_data_processed_20240325.csv
  assay_metadata: assay_metadata/prevent19nvx_assay_metadata.csv
  study_name: PREVENT19
  covariates: ~.+ risk_score
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10 


prevent19_stage2: &prevent19_stage2
  <<: *ows_trial
  two_marker_timepoints: no
  timepoints: [35]
  times: [Day35]
  time_labels: [Day 35]
  data_cleaned: /trials/covpn/p3004/analysis/correlates/stage2/adata/prevent19_stage2_data_processed_20240409.csv
  assay_metadata: assay_metadata/prevent19_stage2_assay_metadata.csv
  study_name: PREVENT19
  covariates: ~ 1  # to be replaced by COR-specific covariates in _common.R
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  

nvx_uk302: &nvx_uk302
  two_marker_timepoints: no
  sampling_scheme: case_control
  timepoints: [35]
  times: [Day35]
  time_labels: [Day 35]
  data_cleaned: /trials/covpn/p3004/analysis/correlates/UK302/adata/nvx_uk302_data_processed_20240320.csv
  assay_metadata: assay_metadata/nvx_uk302_assay_metadata.csv
  study_name: UK302
  covariates: ~.+ Senior + London
  primary_assays: [bindNVXIgG]
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  
  
  
azd1222_base: &azd1222_base
  <<: *ows_trial
  two_marker_timepoints: yes
  timepoints: [29,57]
  times: [B, Day29, Day57, Delta29overB, Delta57overB, Delta57over29]
  time_labels: [Day 1, Day 29, Day 57, D29 fold-rise over D1, D57 fold-rise over D1, D57 fold-rise over D29]
  study_name: AZD1222
  covariates: ~.+ Age + risk_score
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  
azd1222: &azd1222
  <<: *azd1222_base
  data_cleaned: /trials/covpn/p3002/analysis/correlates/Part_A_Blinded_Phase_Data/adata/azd1222_data_processed_with_riskscore.csv.csv
  assays: [pseudoneutid50]
  llox_label: [LOD]
  assay_labels: [PsV Neutralization 50% Titer]
  assay_labels_short: [Pseudovirus-nAb ID50 (IU50/ml)]
  multivariate_assays: [bindSpike+pseudoneutid50]

azd1222_bAb: &azd1222_bAb
  <<: *azd1222_base
  data_cleaned: /trials/covpn/p3002/analysis/correlates/Part_A_Blinded_Phase_Data/adata/azd1222_bAb_data_processed_with_riskscore.csv
  assays: [bindSpike]
  llox_label: [LLOQ]
  assay_labels: [Binding Antibody to Spike]
  assay_labels_short: [Anti Spike IgG (BAU/ml)]

azd1222_stage2: &azd1222_stage2
  <<: *ows_trial
  two_marker_timepoints: no
  timepoints: [57]
  times: [Day57]
  time_labels: [Day 57]
  data_cleaned: /trials/covpn/p3002/analysis/correlates/stage2/adata/azd1222_stage2_data_processed_20240513.csv
  assay_metadata: assay_metadata/azd1222_stage2_assay_metadata.csv
  study_name: AZD1222
  covariates: ~ 1 # to be replaced by COR-specific covariates
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10



####################################################################
# Non-OWS COVID trials

profiscov_base: &profiscov_base
  study_name: PROFISCOV
  case_cohort: yes
  Bserostatus: 0
  covariates: ~.+ HighRiskInd + Sex + Age + BMI
  ve_ylim: [0,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: no
  num_boot_replicates: 1000
  num_perm_replicates: 10000

profiscov: &profiscov
  <<: *profiscov_base
  data_cleaned: /networks/cavd/Objective 4/GH-VAP/ID127-Gast/correlates/adata/profiscov_data_processed_with_riskscore.csv
  two_marker_timepoints: yes
  timepoints: [43,91]
  times: [B, Day43, Day91, Delta43overB, Delta91overB, Delta91over43]
  time_labels: [Day 1, Day 43, Day 91, D43 fold-rise over D1, D91 fold-rise over D1, D91 fold-rise over D43]
  assays: [bindSpike, bindSpike_B.1.1.7, bindSpike_B.1.351, bindSpike_P.1, bindRBD, bindRBD_B.1.1.7, bindRBD_B.1.351, bindRBD_P.1, bindN]
  assay_labels: [Binding Antibody to Spike, Binding Antibody to Spike B.1.1.7, Binding Antibody to Spike B.1.351, Binding Antibody to Spike P.1, Binding Antibody to RBD, Binding Antibody to RBD B.1.1.7, Binding Antibody to RBD B.1.351, Binding Antibody to RBD P.1, Binding Antibody to Nucleocapsid]
  assay_labels_short: [Anti Spike IgG (BAU/ml), Anti Spike B.1.1.7 IgG (BAU/ml), Anti Spike B.1.351 IgG (BAU/ml), Anti Spike P.1 IgG (BAU/ml), Anti RBD IgG (BAU/ml), Anti RBD B.1.1.7 IgG (BAU/ml), Anti RBD B.1.351 IgG (BAU/ml), Anti RBD P.1 IgG (BAU/ml), Anti N IgG (BAU/ml)]
  llox_label: [LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ]

profiscov_lvmn: &profiscov_lvmn
  data_cleaned: /networks/cavd/Objective 4/GH-VAP/ID127-Gast/correlates/adata/profiscov_lvmn_data_processed_with_riskscore.csv
  <<: *profiscov_base
  two_marker_timepoints: no
  timepoints: [43]
  times: [B, Day43, Delta43overB]
  time_labels: [Day 1, Day 43, D43 fold-rise over D1]
  assays: [liveneutmn50]
  assay_labels: [Live Virus Micro Neut 50% Titer]
  assay_labels_short: [Live Virus-mnAb ID50 (IU50/ml)]
  llox_label: [LOD]

  

####################################################################
# Non-COVID trials


id27hpv:
  data_cleaned: /networks/cavd/Objective 4/GH-VAP/ID27-Sankaranarayanan/analysis/correlates/adata/id27hpv_data_processed_20240324.csv
  assay_metadata: assay_metadata/id27hpv_assay_metadata.csv
  sampling_scheme: case_control
  two_marker_timepoints: no
  timepoints: [18]
  times: [M18]
  time_labels: [Month 18]
  study_name: IARCHPV
  covariates: ~.+ AgeGroup
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  primary_assays: [bind_mdw]

id27hpvnAb:
  data_cleaned: /networks/cavd/Objective 4/GH-VAP/ID27-Sankaranarayanan/analysis/correlates/adata/id27hpv_data_processed_20240324.csv
  assay_metadata: assay_metadata/id27hpv_assay_metadata.csv
  sampling_scheme: case_control
  two_marker_timepoints: no
  timepoints: [18]
  times: [M18]
  time_labels: [Month 18]
  study_name: IARCHPV
  covariates: ~.+ AgeGroup
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  primary_assays: [pseudoneutid50_mdw]
  

hvtn705base: &hvtn705base
  sampling_scheme: case_control
  two_marker_timepoints: no
  timepoints: [210]
  times: [B, Day210]
  time_labels: [Day 1, Day 210]
  study_name: HVTN705
  covariates: ~.+ RSA + Age + BMI + Riskscore
  num_boot_replicates: 1000
  num_perm_replicates: 10000
  ve_ylim: [-1,1]
  ve_ylim_log: [0.0,0.98]
  low_efficacy: yes # used to drive some plotting configurations


hvtn705: &hvtn705
  <<: *hvtn705base
  assays: [ELCZ,ADCPgp140C97ZAfib,IgG340mdw_V1V2,IgG340mdw_gp120_gp140_vm,mdw_xassay,ELMo,IgG3gp140C97ZAfibritin40delta,IgG3gp140Mos1fibritin40delta,IgG3gp4140delta,IgG340mdw_gp120,IgG340mdw_gp140,IgG340mdw_multi]
  assay_labels: [IgG Vx-VT-C,ADCP Vx-C97ZA,IgG3 V1V2 breadth,IgG3 Env breadth,Multi-epitope functions,IgG Vx-VT-M,IgG3 gp140 Vx-C97ZA,IgG3 gp140 Vx-Mosaic,IgG3 gp41,IgG3 gp120 breadth,IgG3 gp140 breadth,IgG3 Multi-epitope]
  lloxs: [40,NA,NA,NA,NA,50,NA,NA,NA,NA,NA,NA]
  llox_label: LLOQ
  uloqs: [1884160,NA,NA,NA,NA,1869824,22000,22000,22000,NA,NA,NA]
  primary_assays: [ELCZ,ADCPgp140C97ZAfib,IgG340mdw_V1V2,IgG340mdw_gp120_gp140_vm,mdw_xassay]
  multivariate_assays: [ELCZ+ADCPgp140C97ZAfib+IgG340mdw_V1V2+IgG340mdw_gp120_gp140_vm]
  data_cleaned: /trials/vaccine/p705/analysis/lab/cc/copcor/HVTN705_firstcasecontrolprocesseddata.csv

hvtn705V1V2: &hvtn705V1V2
  <<: *hvtn705base
  assays: [IgG3AE.A244.V1V2.Tags.293F40delta,IgG3C.1086C.V1.V2.Tags40delta,IgG3gp70.001428.2.42.V1V240delta,IgG3gp70.1012.11.TC21.3257.V1V240delta,IgG3gp70.1394C9G1.V1V240delta,IgG3gp70.BF1266.431a.V1V240delta,IgG3gp70.Ce1086.B2.V1V240delta,IgG3gp70.B.CaseA.V1.V240delta]
  assay_labels: [IgG3 V1V2 AE.A244.Tags,IgG3 V1V2 C.1086.Tags,IgG3 gp70 V1V2.001428.2.42,IgG3 gp70 V1V2.1012.11.TC21.3257,IgG3 gp70 V1V2.1394C9G1,IgG3 gp70 V1V2.BF1266.431a,IgG3 gp70 V1V2.Ce1086,IgG3 gp70 V1V2.B.CaseA]
  lloxs: [1,1,1,1,1,1,1,1]
  llox_label: LLOQ
  uloqs: [22000,22000,22000,22000,22000,22000,22000,22000]
  primary_assays: [IgG3AE.A244.V1V2.Tags.293F40delta,IgG3C.1086C.V1.V2.Tags40delta,IgG3gp70.001428.2.42.V1V240delta,IgG3gp70.1012.11.TC21.3257.V1V240delta,IgG3gp70.1394C9G1.V1V240delta,IgG3gp70.BF1266.431a.V1V240delta,IgG3gp70.Ce1086.B2.V1V240delta,IgG3gp70.B.CaseA.V1.V240delta]
  data_cleaned: /trials/vaccine/p705/analysis/lab/cc/copcor/HVTN705_firstcasecontrolprocesseddata_withindividualV1V2markers.csv


# in labels, % is allowed in the middle, but not in the beginning
hvtn705second: &hvtn705second
  <<: *hvtn705base
  data_cleaned: /trials/vaccine/p705/analysis/lab/cc/copcor/HVTN705_secondcasecontrolprocesseddata_v12.csv
  assays: [
         ELCZ,ELMo,ADCPgp140C97ZAfib,ADCPgp140Mos1fib,
         IgG3gp140C97ZAfibritin40delta,IgG3gp140Mos1fibritin40delta,IgG340mdw_gp120,IgG340mdw_gp140,IgG340mdw_V1V2,
         IgG3gp4140delta,IgG340mdw_multi,IgG340mdw_gp120_gp140_vm,
         IgG50mdw_V1V2,mdw_xassay,
         ADCCCAP8_pk,ADCCCH58_pk,ADCCWITO_pk,ADCCCAP8_pAUC,ADCCCH58_pAUC,ADCCWITO_pAUC,
         ICS4AnyEnvIFNg_OR_IL2,ICS8AnyEnvIFNg_OR_IL2,
         IgG3AE.A244.V1V2.Tags_293F40delta,IgG3C.1086C.V1.V2.Tags40delta,IgG3gp70.001428.2.42.V1V240delta,IgG3gp70.1012.11.TC21.3257.V1V240delta,IgG3gp70.1394C9G1.V1V240delta,IgG3gp70.BF1266.431a.V1V240delta,IgG3gp70.Ce1086.B2.V1V240delta,IgG3gp70.B.CaseA.V1.V240delta,
         IgGAE.A244.V1V2.Tags_293F50delta,IgGC.1086C.V1.V2.Tags50delta,IgGgp70_001428.2.42.V1V250delta,IgGgp70_1012.11.TC21.3257.V1V250delta,IgGgp70_1394C9G1.V1V250delta,IgGgp70_9004SS.A3.4.V1V250delta,IgGgp70_BF1266.431a.V1V250delta,IgGgp70_Ce1086.B2.V1V250delta,IgGgp70.B.CaseA.V1.V250delta,
         ICS4JMos1gp120IFNg_OR_IL2, ICS4JMos1gp41IFNg_OR_IL2, ICS4JMos2GagIFNg_OR_IL2, ICS4JMos2RNAseIntIFNg_OR_IL2, ICS4JMos2Sgp120IFNg_OR_IL2, ICS4JMos2Sgp41IFNg_OR_IL2, ICS8JMos1gp120IFNg_OR_IL2, ICS8JMos1gp41IFNg_OR_IL2, ICS8JMos2GagIFNg_OR_IL2, ICS8JMos2RNAseIntIFNg_OR_IL2, ICS8JMos2Sgp120IFNg_OR_IL2, ICS8JMos2Sgp41IFNg_OR_IL2,
         IgG340mdw_V2i, 
         IgG340mdw_V2p, 
         IgG31012.11.TC21D11gp120.avi40delta, 
         IgG31086C.D7gp120.avi_293F40delta, 
         IgG31394C9.G1.D11gp120.avi40delta,
         IgG31428.D11gp120.avi_293F40delta,
         IgG3Con.6.gp120_B40delta,
         ADCPgp701428Alter,
         IgG3.gp70V1V2.CaseA2Alter,
IgACon.6.gp120_B10delta,
IgA1394C9.G1.D11gp120.avi10delta,
IgA1428.D11gp120.avi_293F10delta,          
IgAgp70.1012.11.TC21.3257.V1V210delta,
IgA1086C.D7gp120.avi_293F10delta,
IgAgp140.Mos1.fibritin10delta,
IgAgp140.C97ZA.fibritin10delta,
IgACon.S.gp140.CFI10delta,
IgA1012.gp140C.avi_293F10delta,
IgA1394C9.gp140C.avi_293F10delta,
IgA1086C.gp140C.avi10delta,
IgABF1266.gp140C.avi_293F10delta,          
IgA9004S.gp140C.avi10delta,
IgA00MSA.4076.gp14010delta,
IgAA1.con.env03.140.CF10delta,   
IgA1012.11.TC21D11gp120.avi10delta,
IgAgp70.1394C9G1.V1V210delta,  
IgAgp70.BF1266.431a.V1V210delta,           
IgAgp70.001428.2.42.V1V210delta,             
IgAgp70.Ce1086.B2.V1V210delta,
IgA10mdw_gp120_gp140,  
ADCC_CAP8_CH58_WITO_peak_breadth,
ADCC_CAP8_CH58_WITO_pAUC_breadth,
ELISpotPTEEnv,
mdw_xassay_overall,
mdw_xassay_overall_noelispot,
mdw_xassay_select_igg3v1v2,
IgG340mdw_V1V2_trunc1, 
mdw_xassay_select_igg3v1v2_trunc1,
IgG340mdw_V2i_trunc1, 
IgG340mdw_V2p_trunc1

  ]
  assay_labels: [
        IgG to gp140 C97ZA (EU/ml),
        IgG to VT-M (EU/ml),
        Average phagocytosis score to gp140 C97ZA,
        Average phagocytosis score to gp140 Mos1,
        IgG3 Net MFI to gp140 C97ZA,
        IgG3 Net MFI to gp140 Mosaic,
        IgG3 gp120 breadth (Wt avg log10 Net MFI),
        IgG3 gp140 breadth (Wt avg log10 Net MFI),
        IgG3 V1V2 breadth (Wt avg log10 Net MFI),
        IgG3 Net MFI to gp41,
        IgG3 multi-epitope breadth (Wt avg log10 Net MFI),
        IgG3 gp120 + gp140 breadth (Wt avg log10 Net MFI),
        IgG V1V2 breadth (Wt avg log10 Net MFI),
        Overall maximal diversity score,
        
        Peak baseline-subtracted % loss luc activity to CAP8,
        Peak baseline-subtracted % loss luc activity to CH58,
        Peak baseline-subtracted % loss luc activity to WITO,
        AUC baseline-subtracted CAP8 (% loss of luc activity),
        AUC baseline-subtracted CH58 (% loss of luc activity),
        AUC baseline-subtracted WITO (% loss of luc activity),

        CD4+ T cell responses to any Env peptide pools,
        CD8+ T cell responses to any Env peptide pools,
        IgG3 Net MFI to AE.A244 V1V2 Tags 293F,
        IgG3 Net MFI to C.1086C V1V2 Tags,
        IgG3 Net MFI to gp70-001428.2.42 V1V2,
        IgG3 Net MFI to gp70-1012.11.TC21.3257 V1V2,
        IgG3 Net MFI to gp70-1394C9G1 V1V2,
        IgG3 Net MFI to gp70-BF1266 431a V1V2,
        IgG3 Net MFI to gp70-Ce1086 B2 V1V2,
        IgG3 Net MFI to gp70-B.CaseAV1V2,
        IgG Net MFI to AE.A244 V1V2 Tags 293F,
        IgG Net MFI to C.1086C V1V2 Tags,
        IgG Net MFI to gp70-001428.2.42 V1V2,
        IgG Net MFI to gp70-1012.11.TC21.3257 V1V2,
        IgG Net MFI to gp70-1394C9G1 V1V2,
        IgG Net MFI to gp70-9004SS.A3.4 V1V2,
        IgG Net MFI to gp70-BF1266.431a V1V2,
        IgG Net MFI to gp70-Ce1086.B2 V1V2,
        IgG Net MFI to gp70.B.CaseA V1V2,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos1 gp120,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos1 gp41,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos2 Gag,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos2 RNAseInt,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos2s gp120,
        Pct CD4+ T-cells expressing IFN-g/IL-2 JMos2s gp41,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos1 gp120,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos1 gp41,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos2 Gag,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos2 RNAseInt,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos2s gp120,
        Pct CD8+ T-cells expressing IFN-g/IL-2 JMos2s gp41,
         IgG3 V2i breadth score, 
         IgG3 V2p breadth score, 
         IgG3 Net MFI to gp120 1012.11.TC21D11, 
         IgG3 Net MFI to gp120 1086C.D7, 
         IgG3 Net MFI to gp120 1394C9.G1.D11,
         IgG3 Net MFI to gp120 1428.D11,
         IgG3 Net MFI to gp120 Con6,
         ADCP gp70-1428 V1V2 Alter,
         IgG3 Net MFI to gp70-CaseA2 V1V2 Alter,
IgA Con 6 gp120/B,               
IgA 1394C9 G1.D11gp120.avi,      
IgA 1428 D11gp120.avi/293F,      
IgA 1012 11.TC21D11gp120.avi,    
IgA 1086C D7gp120.avi/293F,      
IgA gp140 Mos1 fibritin,         
IgA gp140 C97ZA fibritin,        
IgA Con S gp140 CFI,             
IgA 1012 gp140C.avi/293F,        
IgA 1394C9 gp140C.avi/293F,      
IgA 1086C gp140C avi,            
IgA BF1266 gp140C.avi/293F,      
IgA 9004S.gp140C.avi,            
IgA 00MSA 4076 gp140,            
IgA A1.con.env03 140 CF,         
IgA gp70-1012.11.TC21.3257 V1V2, 
IgA gp70-1394C9G1 V1V2,          
IgA gp70-BF1266 431a V1V2,       
IgA gp70-001428.2.42 V1V2,       
IgA gp70-Ce1086 B2 V1V2,         
IgA Env breadth score,           
ADCC peak breadth score,         
ADCC pAUC breadth score,
ELISPot PTE Env,
Multi-epitope functions,
Overall maximal diversity score (no ELISPot),
IgG3 V1V2 breadth (AE.A244/C.1086/B.CaseA),
IgG3 V1V2 breadth score trunc1,
IgG3 V1V2 breadth score selected trunc1,
IgG3 V2i breadth score trunc1,
IgG3 V2p breadth score trunc1

]
  assay_labels_short: [
        IgG to gp140 C97ZA,
        IgG to VT-M,
        ADCP gp140 C97ZA,
        ADCP gp140 Mos1,
        IgG3 gp140 C97ZA,
        IgG3 gp140 Mosaic,
        IgG3 gp120 breadth,
        IgG3 gp140 breadth,
        IgG3 V1V2 breadth,
        IgG3 gp41,
        IgG3 multi-epitope breadth,
        IgG3 gp120+gp140 breadth,
        IgG V1V2 breadth,
        Overall max diversity score,
        ADCC Peak CAP8,
        ADCC Peak CH58,
        ADCC Peak WITO,
        ADCC AUC CAP8,
        ADCC AUC CH58,
        ADCC AUC WITO,
        Pct CD4+ T-cells expressing IFN-g/IL-2,
        Pct CD8+ T-cells expressing IFN-g/IL-2,
        IgG3 AE.A244 V1V2 Tags 293F,
        IgG3 C.1086C V1V2 Tags,
        IgG3 gp70-001428.2.42 V1V2,
        IgG3 gp70-1012.11.TC21.3257 V1V2,
        IgG3 gp70-1394C9G1 V1V2,
        IgG3 gp70-BF1266 431a V1V2,
        IgG3 gp70-Ce1086 B2 V1V2,
        IgG3 gp70-B.CaseAV1V2,
        IgG AE.A244 V1V2 Tags 293F,
        IgG C.1086C V1V2 Tags,
        IgG gp70-001428.2.42 V1V2,
        IgG gp70-1012.11.TC21.3257 V1V2,
        IgG gp70-1394C9G1 V1V2,
        IgG gp70-9004SS.A3.4 V1V2,
        IgG gp70-BF1266.431a V1V2,
        IgG gp70-Ce1086.B2 V1V2,
        IgG gp70.B.CaseA V1V2,
        CD4+ T-cells IFN-g/IL-2 JMos1 gp120,
        CD4+ T-cells IFN-g/IL-2 JMos1 gp41,
        CD4+ T-cells IFN-g/IL-2 JMos2 Gag,
        CD4+ T-cells IFN-g/IL-2 JMos2 RNAseInt,
        CD4+ T-cells IFN-g/IL-2 JMos2s gp120,
        CD4+ T-cells IFN-g/IL-2 JMos2s gp41,
        CD8+ T-cells IFN-g/IL-2 JMos1 gp120,
        CD8+ T-cells IFN-g/IL-2 JMos1 gp41,
        CD8+ T-cells IFN-g/IL-2 JMos2 Gag,
        CD8+ T-cells IFN-g/IL-2 JMos2 RNAseInt,
        CD8+ T-cells IFN-g/IL-2 JMos2s gp120,
        CD8+ T-cells IFN-g/IL-2 JMos2s gp41,
        IgG3 V2i breadth score, 
        IgG3 V2p breadth score, 
        IgG3 gp120 1012.11.TC21D11, 
        IgG3 gp120 1086C.D7, 
        IgG3 gp120 1394C9.G1.D11,
        IgG3 gp120 1428.D11,
        IgG3 gp120 Con6,
        ADCP gp70-1428 V1V2 Alter,
        IgG3 gp70-CaseA2 V1V2 Alter,
IgA Con 6 gp120/B,               
IgA 1394C9 G1.D11gp120.avi,      
IgA 1428 D11gp120.avi/293F,      
IgA 1012 11.TC21D11gp120.avi,    
IgA 1086C D7gp120.avi/293F,      
IgA gp140 Mos1 fibritin,         
IgA gp140 C97ZA fibritin,        
IgA Con S gp140 CFI,             
IgA 1012 gp140C.avi/293F,        
IgA 1394C9 gp140C.avi/293F,      
IgA 1086C gp140C avi,            
IgA BF1266 gp140C.avi/293F,      
IgA 9004S.gp140C.avi,            
IgA 00MSA 4076 gp140,            
IgA A1.con.env03 140 CF,         
IgA gp70-1012.11.TC21.3257 V1V2, 
IgA gp70-1394C9G1 V1V2,          
IgA gp70-BF1266 431a V1V2,       
IgA gp70-001428.2.42 V1V2,       
IgA gp70-Ce1086 B2 V1V2,         
IgA Env breadth score,           
ADCC peak breadth score,         
ADCC pAUC breadth score,
ELISPot PTE Env,
Multi-epitope functions,
Overall maximal diversity score (no ELISPot),
IgG3 V1V2 A244/1086/CaseA,
IgG3 V1V2 breadth score trunc1,
IgG3 V1V2 breadth score selected trunc1,
IgG3 V2i breadth score trunc1,
IgG3 V2p breadth score trunc1

  ]
  llox_label: [LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ,LLOQ]
  lloxs:      [80,  100,   NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,  NA,   NA,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA  ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA   ,NA  ,NA,NA,1,1,1,1,1,NA,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,NA,NA,NA,1,NA,NA,NA,NA,NA,NA,NA]
  uloqs: [1884160,1869824,NA,NA,22000,22000,NA,NA,NA,22000,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,22000,22000,22000,22000,22000,NA,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,22000,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA]
  primary_assays: [ELCZ,ADCPgp140C97ZAfib,ICS4AnyEnvIFNg_OR_IL2,ICS8AnyEnvIFNg_OR_IL2,IgG340mdw_V1V2,IgG340mdw_gp120_gp140_vm,mdw_xassay_overall_noelispot]
  multivariate_assays: [
           ELCZ+ADCPgp140C97ZAfib+ICS4AnyEnvIFNg_OR_IL2+ICS8AnyEnvIFNg_OR_IL2+IgG340mdw_V1V2+IgG340mdw_gp120_gp140_vm+mdw_xassay_overall_noelispot 
            #ADCPgp140C97ZAfib+IgG340mdw_V1V2+IgG340mdw_gp120_gp140_vm,
            #ELCZ+ADCPgp140C97ZAfib+IgG50mdw_V1V2+IgG340mdw_gp120_gp140_vm,
            #IgG340mdw_V1V2+IgG50mdw_V1V2    
  ]
  interaction: [
            IgG340mdw_V1V2*ICS4AnyEnvIFNg_OR_IL2,    
            IgG340mdw_V1V2*ICS4JMos1gp120IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS4JMos1gp41IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS4JMos2Sgp120IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS4JMos2Sgp41IFNg_OR_IL2,            
            IgG340mdw_V1V2*ICS4JMos2GagIFNg_OR_IL2,
            IgG340mdw_V1V2*ICS4JMos2RNAseIntIFNg_OR_IL2,    
            IgG3gp70.001428.2.42.V1V240delta*ICS4AnyEnvIFNg_OR_IL2,            
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos1gp120IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos1gp41IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos2Sgp120IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos2Sgp41IFNg_OR_IL2,    
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos2GagIFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS4JMos2RNAseIntIFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4AnyEnvIFNg_OR_IL2,    
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos1gp120IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos1gp41IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos2Sgp120IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos2Sgp41IFNg_OR_IL2,            
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos2GagIFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS4JMos2RNAseIntIFNg_OR_IL2,
            IgG340mdw_V1V2*ICS8AnyEnvIFNg_OR_IL2,    
            IgG340mdw_V1V2*ICS8JMos1gp120IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS8JMos1gp41IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS8JMos2Sgp120IFNg_OR_IL2,
            IgG340mdw_V1V2*ICS8JMos2Sgp41IFNg_OR_IL2,            
            IgG340mdw_V1V2*ICS8JMos2GagIFNg_OR_IL2,
            IgG340mdw_V1V2*ICS8JMos2RNAseIntIFNg_OR_IL2,    
            IgG3gp70.001428.2.42.V1V240delta*ICS8AnyEnvIFNg_OR_IL2,            
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos1gp120IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos1gp41IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos2Sgp120IFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos2Sgp41IFNg_OR_IL2,    
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos2GagIFNg_OR_IL2,
            IgG3gp70.001428.2.42.V1V240delta*ICS8JMos2RNAseIntIFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8AnyEnvIFNg_OR_IL2,    
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos1gp120IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos1gp41IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos2Sgp120IFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos2Sgp41IFNg_OR_IL2,            
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos2GagIFNg_OR_IL2,
            IgG3AE.A244.V1V2.Tags_293F40delta*ICS8JMos2RNAseIntIFNg_OR_IL2
  ]

hvtn705secondRSA: &hvtn705secondRSA
  inherits: hvtn705second
  covariates: ~.+ Age + BMI + Riskscore

hvtn705secondNonRSA: &hvtn705secondNonRSA
  inherits: hvtn705second
  covariates: ~.+ Age + BMI + Riskscore




###################################################################################################
# correlates analyses

# there are some redundancy in ph1, ph2, WtStratum, wt in that given the first three, we can compute wt
# the redundancy is not needed if we only have single time point analyses
# but for double time points analyses, we need more than one weight variable
# the reason we need WtStratum is that for bootstrapping (needed for some single time point analyses)

# primary endpoint D57 markers
D57:
  ph1: ph1.D57
  ph2: ph2.D57
  wt: wt.D57
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD57
  EventTimePrimary: EventTimePrimaryD57
  Earlyendpoint: EarlyendpointD57
  tpeak: 57
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.

# same as D57, except that in _common.R, tfinal.tpeak is set to xx instead of 100 in _common.R
D57a:
  ph1: ph1.D57
  ph2: ph2.D57
  wt: wt.D57
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD57
  EventTimePrimary: EventTimePrimaryD57
  Earlyendpoint: EarlyendpointD57
  tpeak: 57
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.

# primary endpoint, Delta57over29 markers
# used to study fold change in moderna
D57over29:
  ph1: ph1.D57
  ph2: ph2.D57
  wt: wt.D57
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD57
  EventTimePrimary: EventTimePrimaryD57
  Earlyendpoint: EarlyendpointD57
  tpeak: Delta57over29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.

# primary endpoint D29 markers
D29:
  ph1: ph1.D29
  ph2: ph2.D29
  wt: wt.D29
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD29
  EventTimePrimary: EventTimePrimaryD29
  Earlyendpoint: EarlyendpointD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 29 visit; no. cases = number of this cohort with an observed COVID endpoint.



# for bAb markers
D22vat08_combined_M6_bAb:
  ph1: ph1.D22
  ph2: ph2.D22.bAb
  wt: wt.D22.bAb
  WtStratum: Wstratum.bAb
  EventIndPrimary:  EventIndOmicronD22M6hotdeck
  EventTimePrimary: EventTimeOmicronD22M6hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 180
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D22vat08_combined_M12_bAb:
  ph1: ph1.D22
  ph2: ph2.D22.bAb
  wt: wt.D22.bAb
  WtStratum: Wstratum.bAb
  EventIndPrimary:  EventIndOmicronD22M12hotdeck
  EventTimePrimary: EventTimeOmicronD22M12hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 360
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M6_bAb:
  ph1: ph1.D43
  ph2: ph2.D43.bAb
  wt: wt.D43.bAb
  WtStratum: Wstratum.bAb
  EventIndPrimary:  EventIndOmicronD43M6hotdeck
  EventTimePrimary: EventTimeOmicronD43M6hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 159
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M12_bAb:
  ph1: ph1.D43
  ph2: ph2.D43.bAb
  wt: wt.D43.bAb
  WtStratum: Wstratum.bAb
  EventIndPrimary:  EventIndOmicronD43M12hotdeck
  EventTimePrimary: EventTimeOmicronD43M12hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 339
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.


# for nAb markers
# note that the ph2 variable is overloaded
# it means the availaiblility of variant nAbs and all nAbs in stage 1 and 2, respectively
# for stage 1 ancestral nAb, use wt.Dxx.nAb.st1.anc/ph2.Dxx.nAb.st1.anc (Wstratum.nAb is the same as other nAb markers)
D22vat08_combined_M6_nAb:
  ph1: ph1.D22
  ph2: ph2.D22.nAb
  wt: wt.D22.nAb
  WtStratum: Wstratum.nAb
  EventIndPrimary:  EventIndOmicronD22M6hotdeck
  EventTimePrimary: EventTimeOmicronD22M6hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 180
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D22vat08_combined_M12_nAb:
  ph1: ph1.D22
  ph2: ph2.D22.nAb
  wt: wt.D22.nAb
  WtStratum: Wstratum.nAb
  EventIndPrimary:  EventIndOmicronD22M12hotdeck
  EventTimePrimary: EventTimeOmicronD22M12hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 360
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M6_nAb:
  ph1: ph1.D43
  ph2: ph2.D43.nAb
  wt: wt.D43.nAb
  WtStratum: Wstratum.nAb
  EventIndPrimary:  EventIndOmicronD43M6hotdeck
  EventTimePrimary: EventTimeOmicronD43M6hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 159
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M12_nAb:
  ph1: ph1.D43
  ph2: ph2.D43.nAb
  wt: wt.D43.nAb
  WtStratum: Wstratum.nAb
  EventIndPrimary:  EventIndOmicronD43M12hotdeck
  EventTimePrimary: EventTimeOmicronD43M12hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 339
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.


# for inferences requiring all markers, including nAb and bAb, ancestral and variant
D22vat08_combined_M6_both:
  ph1: ph1.D22
  ph2: ph2.D22.both
  wt: wt.D22.both
  WtStratum: Wstratum.both
  EventIndPrimary:  EventIndOmicronD22M6hotdeck
  EventTimePrimary: EventTimeOmicronD22M6hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 180
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D22vat08_combined_M12_both:
  ph1: ph1.D22
  ph2: ph2.D22.both
  wt: wt.D22.both
  WtStratum: Wstratum.both
  EventIndPrimary:  EventIndOmicronD22M12hotdeck
  EventTimePrimary: EventTimeOmicronD22M12hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 360
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M6_both:
  ph1: ph1.D43
  ph2: ph2.D43.both
  wt: wt.D43.both
  WtStratum: Wstratum.both
  EventIndPrimary:  EventIndOmicronD43M6hotdeck
  EventTimePrimary: EventTimeOmicronD43M6hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 159
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M12_both:
  ph1: ph1.D43
  ph2: ph2.D43.both
  wt: wt.D43.both
  WtStratum: Wstratum.both
  EventIndPrimary:  EventIndOmicronD43M12hotdeck
  EventTimePrimary: EventTimeOmicronD43M12hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 339
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.


# for nAb markers sensitivity analysis in stage 2 non-naive, using batch 2 data only
D22vat08_combined_M6_nAb.st2.sen:
  ph1: ph1.D22.st2
  ph2: ph2.D22.nAb.st2.sen
  wt: wt.D22.nAb.st2.sen
  WtStratum: Wstratum.nAb.st2.sen
  EventIndPrimary:  EventIndOmicronD22M6hotdeck
  EventTimePrimary: EventTimeOmicronD22M6hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 180
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D22vat08_combined_M12_nAb.st2.sen:
  ph1: ph1.D22.st2
  ph2: ph2.D22.nAb.st2.sen
  wt: wt.D22.nAb.st2.sen
  WtStratum: Wstratum.nAb.st2.sen
  EventIndPrimary:  EventIndOmicronD22M12hotdeck
  EventTimePrimary: EventTimeOmicronD22M12hotdeck
  Earlyendpoint: EarlyendpointD22
  tpeak: 22
  tpeaklag: 7
  tfinal.tpeak: 360
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 22 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M6_nAb.st2.sen:
  ph1: ph1.D43.st2
  ph2: ph2.D43.nAb.st2.sen
  wt: wt.D43.nAb.st2.sen
  WtStratum: Wstratum.nAb.st2.sen
  EventIndPrimary:  EventIndOmicronD43M6hotdeck
  EventTimePrimary: EventTimeOmicronD43M6hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 159
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.
D43vat08_combined_M12_nAb.st2.sen:
  ph1: ph1.D43.st2
  ph2: ph2.D43.nAb.st2.sen
  wt: wt.D43.nAb.st2.sen
  WtStratum: Wstratum.nAb.st2.sen
  EventIndPrimary:  EventIndOmicronD43M12hotdeck
  EventTimePrimary: EventTimeOmicronD43M12hotdeck
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  tfinal.tpeak: 339
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.



# PROFISCOV
D43:
  ph1: ph1.D43
  ph2: ph2.D43
  wt: wt.D43
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD43
  EventTimePrimary: EventTimePrimaryD43
  Earlyendpoint: EarlyendpointD43
  tpeak: 43
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 43 visit; no. cases = number of this cohort with an observed COVID endpoint.

# PROFISCOV
D91:
  ph1: ph1.D91
  ph2: ph2.D91
  wt: wt.D91
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD91
  EventTimePrimary: EventTimePrimaryD91
  Earlyendpoint: EarlyendpointD91
  tpeak: 91
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 91 visit; no. cases = number of this cohort with an observed COVID endpoint.

# primary endpoint D43 markers, but the analysis population is D91. For profiscov
D43start48:
  ph1: ph1.D91
  ph2: ph2.D91
  wt: wt.D91
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD91
  EventTimePrimary: EventTimePrimaryD91
  Earlyendpoint: EarlyendpointD91
  tpeak: 43
  tpeaklag: 55 # 7 + 48
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.

D91over43:
  ph1: ph1.D91
  ph2: ph2.D91
  wt: wt.D91
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD91
  EventTimePrimary: EventTimePrimaryD91
  Earlyendpoint: EarlyendpointD91
  tpeak: Delta91over43
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.


# primary endpoint D29 markers, but the analysis population is D57. For AZ and COVE
D29start28:
  ph1: ph1.D57
  ph2: ph2.D57
  wt: wt.D57
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD57
  EventTimePrimary: EventTimePrimaryD57
  Earlyendpoint: EarlyendpointD57
  tpeak: 29
  tpeaklag: 35 # 7 + 28
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 57 visit; no. cases = number of this cohort with an observed COVID endpoint.

D35:
  ph1: ph1.D35
  ph2: ph2.D35
  wt: wt.D35
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD35
  EventTimePrimary: EventTimePrimaryD35
  Earlyendpoint: EarlyendpointD35
  tpeak: 35
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 35 visit; no. cases = number of this cohort with an observed COVID endpoint.

D35nvx_uk302:
  ph1: ph1.D35
  ph2: ph2.D35
  wt: wt.D35
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD35
  EventTimePrimary: EventTimePrimaryD35
  Earlyendpoint: EarlyendpointD35
  tpeak: 35
  tpeaklag: 7
  tfinal.tpeak: 134
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 35 visit; no. cases = number of this cohort with an observed COVID endpoint.

D35prevent19nvx:
  ph1: ph1.D35
  ph2: ph2.D35NVX
  wt: wt.D35NVX
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD35
  EventTimePrimary: EventTimePrimaryD35
  Earlyendpoint: EarlyendpointD35
  tpeak: 35
  tpeaklag: 7
  tfinal.tpeak: 59
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 35 visit; no. cases = number of this cohort with an observed COVID endpoint.

D35prevent19_stage2_delta:
  ph1: ph1.D35_108
  ph2: ph2.D35_108
  wt: wt.D35_108
  WtStratum: Wstratum
  EventIndPrimary: KnownOrImputedDeltaCOVIDIndD35_108to21Dec10
  EventTimePrimary: COVIDTimeD35to21Dec10
  Earlyendpoint: AnyEndpointD35_108
  covariates: ~.+ Senior
  tpeak: 35
  tpeaklag: 108
  tfinal.tpeak: 305
  txt.endpoint: Delta COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

D35prevent19_stage2_severe:
  ph1: ph1.D35_108
  ph2: ph2.D35_108
  wt: wt.D35_108
  WtStratum: Wstratum
  EventIndPrimary:  SevereCOVIDIndD35_108to21Dec10
  EventTimePrimary: SevereCOVIDTimeD35to21Dec10
  Earlyendpoint: AnyInfectionD35_108
  covariates: ~.+ Age
  tpeak: 35
  tpeaklag: 108
  tfinal.tpeak: 305
  txt.endpoint: Severe COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

# delta
D57azd1222_stage2_delta_nAb:
  ph1: ph1.D57_120
  ph2: ph2.D57_120nAb
  wt: wt.D57_120nAb
  WtStratum: Wstratum
  EventIndPrimary: KnownOrImputedDeltaCOVIDIndD57_120toD57_270
  EventTimePrimary: COVIDTimeD57toD57_270
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Senior + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 270
  txt.endpoint: Delta COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

D57azd1222_stage2_delta_bAb:
  ph1: ph1.D57_120
  ph2: ph2.D57_120bAb
  wt: wt.D57_120bAb
  WtStratum: Wstratum
  EventIndPrimary: KnownOrImputedDeltaCOVIDIndD57_120toD57_270
  EventTimePrimary: COVIDTimeD57toD57_270
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Senior + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 270
  txt.endpoint: Delta COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

D57azd1222_stage2_delta_nAb_sens:
  ph1: ph1.D57_120
  ph2: ph2.D57_120nAb
  wt: wt.D57_120nAb
  WtStratum: Wstratum
  EventIndPrimary: KnownOrImputedDeltaCOVIDIndD57_120toD57_180
  EventTimePrimary: COVIDTimeD57toD57_180
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Senior + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 180
  txt.endpoint: Delta COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

D57azd1222_stage2_delta_bAb_sens:
  ph1: ph1.D57_120
  ph2: ph2.D57_120bAb
  wt: wt.D57_120bAb
  WtStratum: Wstratum
  EventIndPrimary: KnownOrImputedDeltaCOVIDIndD57_120toD57_180
  EventTimePrimary: COVIDTimeD57toD57_180
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Senior + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 180
  txt.endpoint: Delta COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

# severe
D57azd1222_stage2_severe_nAb:
  ph1: ph1.D57_120
  ph2: ph2.D57_120nAb
  wt: wt.D57_120nAb
  WtStratum: Wstratum
  EventIndPrimary: SevereCOVIDIndD57_120to21Dec10
  EventTimePrimary: SevereCOVIDTimeD57to21Dec10
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Age + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 304
  txt.endpoint: Severe COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

D57azd1222_stage2_severe_bAb:
  ph1: ph1.D57_120
  ph2: ph2.D57_120bAb
  wt: wt.D57_120bAb
  WtStratum: Wstratum
  EventIndPrimary: SevereCOVIDIndD57_120to21Dec10
  EventTimePrimary: SevereCOVIDTimeD57to21Dec10
  Earlyendpoint: AnyInfectionD57_120
  covariates: ~.+ Age + risk_score
  tpeak: 57
  tpeaklag: 120
  tfinal.tpeak: 304
  txt.endpoint: Severe COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients without evidence for symptomatic or asymptomatic COVID.

# sensitivity analyses for D29 markers, starting at 1, instead of 7, day after D29 visit
D29start1:
  ph1: ph1.D29start1
  ph2: ph2.D29start1
  wt: wt.D29start1
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD29
  EventTimePrimary: EventTimePrimaryD29
  Earlyendpoint: EarlyendpointD29start1
  tpeak: 29
  tpeaklag: 1
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through Day 29 visit; no. cases = number of this cohort with an observed COVID endpoint.

# primary endpoint D29 markers
# IncludeNotMolecConfirmed, for ensemble
D29IncludeNotMolecConfirmed:
  ph1: ph1.D29
  ph2: ph2.D29
  wt: wt.D29
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryIncludeNotMolecConfirmedD29
  EventTimePrimary: EventTimePrimaryIncludeNotMolecConfirmedD29
  Earlyendpoint: EarlyendpointD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 29 visit; no. cases = number of this cohort with an observed COVID endpoint.

D29SevereIncludeNotMolecConfirmed: 
  ph1: ph1.D29
  ph2: ph2.D29
  wt: wt.D29
  WtStratum: Wstratum
  EventIndPrimary:  SevereEventIndPrimaryIncludeNotMolecConfirmedD29
  EventTimePrimary: SevereEventTimePrimaryIncludeNotMolecConfirmedD29
  Earlyendpoint: EarlyendpointD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 29 visit; no. cases = number of this cohort with an observed severe COVID endpoint.

D29ModerateIncludeNotMolecConfirmed: 
  ph1: ph1.D29
  ph2: ph2.D29
  wt: wt.D29
  WtStratum: Wstratum
  EventIndPrimary:  ModerateEventIndPrimaryIncludeNotMolecConfirmedD29
  EventTimePrimary: ModerateEventTimePrimaryIncludeNotMolecConfirmedD29
  Earlyendpoint: EarlyendpointD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 29 visit; no. cases = number of this cohort with an observed moderate COVID endpoint.

# sensitivity analyses for D29 markers, starting at 1, instead of 7, day after D29 visit
# IncludeNotMolecConfirmed, for ensemble
D29IncludeNotMolecConfirmedstart1:
  ph1: ph1.D29start1
  ph2: ph2.D29start1
  wt: wt.D29start1
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryIncludeNotMolecConfirmedD29
  EventTimePrimary: EventTimePrimaryIncludeNotMolecConfirmedD29
  Earlyendpoint: EarlyendpointD29start1
  tpeak: 29
  tpeaklag: 1
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through Day 29 visit; no. cases = number of this cohort with an observed COVID endpoint.

# VL, ph2/wt for ancestral antibodies do have variant in the end
# We don't keep a separate label for ancestral ph2 and weights and rely on hard coding to change them 
# b/c it is a lot better to keep reults for ancestral and variant antibodies together for easier read
# the hard coding happens in cor_coxph_ph_MI.R and in copcor::marginalized.risk.svycoxph.boot.R
D29VLvariant:
  ph1: ph1.D29
  ph2: ph2.D29variant
  wt: wt.D29variant
  WtStratum: Wstratum
  EventIndPrimary: EventIndPrimaryD29
  EventTimePrimary: EventTimePrimaryD29
  Earlyendpoint: EarlyendpointD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 29 visit; no. cases = number of this cohort with an observed COVID endpoint.

D210:
  ph1: Ph1ptids.D210
  ph2: Ph2ptids.D210
  wt: wt.D210
  WtStratum: Sampstratum.D210
  tpsStratum: tps.stratum
  EventIndPrimary: Delta.D210
  EventTimePrimary: Ttilde.D210
  tpeak: 210
  tpeaklag: 1
  txt.endpoint: HIV
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. per-protocol vaccine recipients not infected through 1 days post Month 7 visit; no. cases = number of this cohort with an observed endpoint.

# moderna_boost
# BD29nnaive and BD29naive are identical in config, but in the code, different data are analyzed through cleandata.R (moderna_boost, cor_threshol)
BD29naive:
  ph1: ph1.BD29
  ph2: ph2.BD29
  wt: wt.BD29
  WtStratum: Wstratum
  EventIndPrimary:  EventIndOmicronBD29
  EventTimePrimary: EventTimeOmicronBD29
  Earlyendpoint: EarlyendpointBD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants not experiencing the COVID endpoint or infected through 6 days post BD29 visit; no. cases = number of this cohort with an observed COVID endpoint.

BD29nnaive:
  ph1: ph1.BD29
  ph2: ph2.BD29
  wt: wt.BD29
  WtStratum: Wstratum
  EventIndPrimary:  EventIndOmicronBD29
  EventTimePrimary: EventTimeOmicronBD29
  Earlyendpoint: EarlyendpointBD29
  tpeak: 29
  tpeaklag: 7
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants not experiencing the COVID endpoint or infected through 6 days post BD29 visit; no. cases = number of this cohort with an observed COVID endpoint.

# hpv
M18:
  ph1: ph1.M18
  ph2: ph2.M18
  wt: wt.M18
  WtStratum: Wstratum
  EventIndPrimary:  EventIndPrimaryAnyHPV
  EventTimePrimary: 
  Earlyendpoint: 
  tpeak: 18
  tpeaklag: 0
  txt.endpoint: HPV
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants entering or eligible to enter the sampling cohort post the M18 visit; no. cases = number of this cohort with an observed HPV endpoint.

# hpv
M18sus:
  ph1: ph1.M18.sus
  ph2: ph2.M18.sus
  wt: wt.M18.sus
  WtStratum: Wstratum
  EventIndPrimary:  EventIndPrimaryAnyHPV
  EventTimePrimary: 
  Earlyendpoint: 
  tpeak: 18
  tpeaklag: 0
  txt.endpoint: HPV
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants becoming susceptible to HPV infection post the M18 visit; no. cases = number of this cohort with an observed HPV endpoint.

# hpv
M18nAb:
  ph1: ph1.M18
  ph2: ph2.M18.nAb
  wt: wt.M18.nAb
  WtStratum: Wstratum
  EventIndPrimary:  EventIndPrimaryAnyHPV
  EventTimePrimary: 
  Earlyendpoint: 
  tpeak: 18
  tpeaklag: 0
  txt.endpoint: HPV
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants entering or eligible to enter the sampling cohort post the M18 visit; no. cases = number of this cohort with an observed HPV endpoint.

# hpv
M18susnAb:
  ph1: ph1.M18.sus
  ph2: ph2.M18.sus.nAb
  wt: wt.M18.sus.nAb
  WtStratum: Wstratum
  EventIndPrimary:  EventIndPrimaryAnyHPV
  EventTimePrimary: 
  Earlyendpoint: 
  tpeak: 18
  tpeaklag: 0
  txt.endpoint: HPV
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. trial participants becoming susceptible to HPV infection post the M18 visit; no. cases = number of this cohort with an observed HPV endpoint.

# covail. used to study D15 markers in followup from D22 to 91
D15to91: 
  ph1: ph1.D15
  ph2: ph2.D15
  wt: wt.D15
  WtStratum: Wstratum
  EventIndPrimary: COVIDIndD22toD91
  EventTimePrimary: COVIDTimeD22toD91
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  torigin: 15
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.

# covail. used to study D15 markers in followup from D22 to 181
D15to181:
  ph1: ph1.D15
  ph2: ph2.D15
  wt: wt.D15
  WtStratum: Wstratum
  EventIndPrimary: COVIDIndD22toD181
  EventTimePrimary: COVIDTimeD22toD181
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  torigin: 15
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.

# covail. used to study D15 markers in followup from D92 to 181
D92to181:
  ph1: ph1.D92
  ph2: ph2.D92
  wt: wt.D92
  WtStratum: Wstratum
  EventIndPrimary: COVIDIndD92toD181
  EventTimePrimary: COVIDTimeD92toD181
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  torigin: 15
  txt.endpoint: COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 91 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.



# covail, BA4/BA5. used to study D15 markers in followup from D22 to 91
D15to91BA45: 
  ph1: ph1.D15
  ph2: ph2.D15
  wt: wt.D15
  WtStratum: Wstratum
  EventIndPrimary: EventIndOfInterest
  EventTimePrimary: COVIDTimeD22toD91
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  torigin: 15
  txt.endpoint: BA4BA5 COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.

# covail, BA4/BA5. used to study D15 markers in followup from D22 to 181
D15to181BA45:
  ph1: ph1.D15
  ph2: ph2.D15
  wt: wt.D15
  WtStratum: Wstratum
  EventIndPrimary: EventIndOfInterest
  EventTimePrimary: COVIDTimeD22toD181
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  tfinal.tpeak: 188
  torigin: 15
  txt.endpoint: BA4BA5 COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 6 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.

# covail, BA4/BA5. used to study D15 markers in followup from D92 to 181
D92to181BA45:
  ph1: ph1.D92
  ph2: ph2.D92
  wt: wt.D92
  WtStratum: Wstratum
  EventIndPrimary: EventIndOfInterest
  EventTimePrimary: COVIDTimeD92toD181
  Earlyendpoint: EarlyendpointD15
  tpeak: 15
  tpeaklag: 7
  torigin: 15
  txt.endpoint: BA4BA5 COVID
  txt.coxph.note2: No. at-risk = estimated number in the population for analysis, i.e. baseline negative per-protocol vaccine recipients not experiencing the COVID endpoint or infected through 91 days post Day 15 visit; no. cases = number of this cohort with an observed COVID endpoint.

####################
# two time points

D29D57:
  tinterm: 29
  tpeak: 57
  tpeaklag: 7
  txt.endpoint: COVID

D22D43:
  tinterm: 22
  tpeak: 43
  tpeaklag: 7
  txt.endpoint: COVID  
   
D22D43omi:
  tinterm: 22
  tpeak: 43
  tpeaklag: 7
  txt.endpoint: COVID  
  EventIndPrimary: EventIndOmicron
  EventTimePrimary: EventTimeOmicron 
  
D43D91:
  tinterm: 43
  tpeak: 91
  tpeaklag: 7
  txt.endpoint: COVID
